%h2
  = link_to customer_path(@customer.uid) do
    #{@customer.customer_name} æ§˜
  (#{@order.customer.customer_type.customer_type_name}) /ã”æ³¨æ–‡ID :
  = link_to @order.uid, 'https://mail.google.com/mail/u/0/#search/'+@order.uid, target:["_blank"]
  -# = PaymentMethod.find(@order.customer)

%h3 ã”æ³¨æ–‡æ—¥æ™‚(å—ä¿¡æ—¥æ™‚) : #{l(@order.order_date, format: :long, default: '')}
%h3 ã¿ã¤ã‚‚ã‚Šé›£æ˜“åº¦ : #{QuoteDifficultyLevel.find(@order.quote_difficulty_level_id).quote_difficulty_level_name}

- if OrderNote.find_by(order_id: @order.id).present?
  %p
    %b ã”æ³¨æ–‡å‚™è€ƒæ¬„ : #{OrderNote.find_by(order_id: @order.id).order_note}
    (è¨˜å…¥è€… : #{User.find(OrderNote.find_by(order_id: @order.id).user_id).user_name})

= form_with model: @order, local: true do |f|
  = f.hidden_field :customer_id, value: @customer.id
  = f.hidden_field :order_reflect_user_id, value: current_user.id
  = f.hidden_field :representative_user_id, value: 1
  = f.hidden_field :progress_id, value: 1
  = f.hidden_field :shipment_user_id, value: 1

  %br
  .field
    = f.label :order_type_name, "ã”æ³¨æ–‡ç¨®åˆ¥"
    = f.collection_select(:order_type_id, OrderType.all, :id, :order_type_name)

  %br
  %h3 â³ç´å“å…ˆã¨ç´æœŸã«ã¤ã„ã¦
  .field
    = f.fields_for :order_addresses, OrderAddress.new do |a|
      = a.label :customer_address_id, "ç´å“å…ˆ"
      = a.collection_select(:customer_address_id, CustomerAddress.where(customer_id: @customer.id), :id, :view_prefecture_name)

  .field
    = f.label :desired_delivery_date, "ç´å“ã”å¸Œæœ›æ—¥"
    = f.date_field :desired_delivery_date, autofocus: true, autocomplete: "desired_delivery_date"

  .field
    = f.label :desired_delivery_type_name, "ç´å“ã”å¸Œæœ›æ—¥ã®ç¨®é¡"
    = f.collection_select(:desired_delivery_type_id, DesiredDeliveryType.all, :id, :desired_delivery_type_name)

  .field
    = f.label :specified_time_name, "æ™‚é–“å¸¯æŒ‡å®š"
    = f.collection_select(:specified_time_id, SpecifiedTime.all, :id, :specified_time_name)

  %br
  %h3 ğŸ£åˆ¶ä½œãƒ»åŠ å·¥å†…å®¹ã«ã¤ã„ã¦
  .border-field
    = f.fields_for :order_details, OrderDetail.new do |d|
      = d.label :mixed_techniques, "ğŸ¥åŠ å·¥ã®ç¨®é¡"
      = d.radio_button :mixed_techniques, :unmixed
      = d.label :mixed_techniques, "å˜ç‹¬åŠ å·¥", {value: :unmixed, style: "display: inline-block;"}
      = d.radio_button :mixed_techniques, :mixed
      = d.label :mixed_techniques, "åˆä½“åŠ å·¥", {value: :mixed, style: "display: inline-block;"}

      %br/
      %br/
      = d.fields_for :order_technique_details, OrderTechniqueDetail.new do |t|
        = t.label :technique_name, "ğŸ¤åŠ å·¥å†…å®¹ã®è©³ç´°"
        = t.collection_select(:technique_id, Technique.all, :id, :technique_name)

      -#%br/
      -#%br/
      -# = d.fields_for :order_technique_detail_options, OrderTechniqueDetailOption.new do |o|
      -#   = o.label :åŠ å·¥å†…å®¹ã®è©³ç´°ã‚ªãƒ—ã‚·ãƒ§ãƒ³
      -#   = o.collection_select(:technique_option_id, TechniqueOption.all, :id, :technique_option_name)

      %br/
      %br/
      = d.label :large_order, "ğŸ¦é€šå¸¸ï¼å¤§å£"
      = d.radio_button :large_order, :small
      = d.label :large_order, "é€šå¸¸æ³¨æ–‡", {value: :small, style: "display: inline-block;"}
      = d.radio_button :large_order, :large
      = d.label :large_order, "å¤§å£æ³¨æ–‡", {value: :large, style: "display: inline-block;"}
      = d.hidden_field :factory_id, value: current_user.id

  %br
  %h3 ğŸ“¦ç™ºæ³¨å†…å®¹ã«ã¤ã„ã¦
  .field
    = f.label :domestic_buying, "ğŸššå›½å†…ç™ºæ³¨å•†å“ã¯"
    = f.radio_button :domestic_buying, :not_included
    = f.label :domestic_buying, "å«ã¾ã‚Œãªã„", {value: :not_included, style: "display: inline-block;"}
    = f.radio_button :domestic_buying, :included
    = f.label :domestic_buying, "å«ã¾ã‚Œã‚‹", {value: :included, style: "display: inline-block;"}

  .field
    = f.label :overseas_buying, "ğŸšæµ·å¤–ç™ºæ³¨å•†å“ã¯"
    = f.radio_button :overseas_buying, :not_included
    = f.label :overseas_buying, "å«ã¾ã‚Œãªã„", {value: :not_included, style: "display: inline-block;"}
    = f.radio_button :overseas_buying, :included
    = f.label :overseas_buying, "å«ã¾ã‚Œã‚‹", {value: :included, style: "display: inline-block;"}

  .field
    = f.label :carry_in, "ğŸ¡ãŠæŒè¾¼å•†å“ã¯"
    = f.radio_button :carry_in, :not_included
    = f.label :carry_in, "å«ã¾ã‚Œãªã„", {value: :not_included, style: "display: inline-block;"}
    = f.radio_button :carry_in, :included
    = f.label :carry_in, "å«ã¾ã‚Œã‚‹", {value: :included, style: "display: inline-block;"}

  %br
  %h3 ğŸ’´ã”å…¥é‡‘ã«ã¤ã„ã¦
  %b ãŠæ”¯æ‰•ã„æ–¹æ³• :

  %br/
  %br/
  .field
    = f.label :payment_deadline_date, "ãŠæ”¯æ‰•ã„æœŸé™æ—¥"
    = f.date_field :payment_deadline_date, autofocus: true, autocomplete: "payment_deadline_date"

  .field
    = f.label :payment_amount, "åˆè¨ˆé‡‘é¡"
    = f.number_field :payment_amount, autofocus: true, autocomplete: "payment_deadline"


  .field
    = f.fields_for :order_notes, OrderNote.new do |n|
      = n.label :order_note, "ã”æ³¨æ–‡ã®å‚™è€ƒæ¬„"
      = n.text_area :order_note, autofocus: true, autocomplete: "order_note"
      = n.hidden_field :user_id, value: current_user.id

  .actions
    = f.submit "ã”æ³¨æ–‡ã‚’ç™»éŒ²"
